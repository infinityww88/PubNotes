<html>
    <head>
        <title>
            Bash extend
        </title>
    </head>
    <body>
        <h1 style="text-align: center;">Bash扩展</h1>
        高优先级的扩展结果可以用在低优先级的扩展中
        <h3>
            1. 花括号扩展
        </h3>
        <p>
            echo a{b,c}d =><br />
            abd acd<br />
            可以使用范围，支持数字和字母<br />
            echo a{1..10} =><br />
            a1 a2 a3 a4 a5 a6 a7 a8 a9 a10<br />
            花括号之间不能有空格
        </p>

        <h3>
            2. 波浪形扩展
        </h3>
        <p>
            必须是一个token的开头，不能是中间<br />
            波浪形前缀：波浪形之后，第一个/或者:未被引号括起来的字符串<br />
            根据波浪形前缀扩展 波浪形+前缀：
            <ul>
                <li>
                    如果是有效的用户名，则扩展为用户主目录
                </li>
                <li>
                    如果为空则替换为用户主目录
                </li>
                <li>
                    如果为+则替换为当前工作目录（PWD）
                </li>
                <li>
                    如果为-则替换为上一个工作目录（OLDPWD）
                </li>
            </ul>
        </p>

        <h3>
            3. 变量扩展
        </h3>
        <p>
            $var，更通用的格式是${var}<br/>
            ${!var}，间接引用一层var，读取var的值作为变量名引用的变量<br />
        </p>

        <h3>
            4. 命令替换
        </h3>
        <p>
            $(cmd)或者`cmd`<br />
            用命令的输出替换命令本身
        </p>

        <h3>
            5. 算术扩展
        </h3>
        <p>
            $((expr))，只支持四则元算，可以出现变量，因为变量扩展在之前会被执行
        </p>

        <h3>
            6. 路径扩展
        </h3>
        <p>
            shell扫描每个token看是否有* ? []。这三个操作符用来路径扩展（glob匹配）。如果出现任何一个，token就被认为是一个模式，shell会对当前目录下的文件列表按照文件名的顺序一一与模式进行匹配，然后用所有能匹配的文件名进行替换这个模式
            <ul>
                <li>
                    *: 匹配0到多个字符
                </li>
                <li>
                    ?: 匹配任何一个字符
                </li>
                <li>
                    []: 匹配[]中定义的一个字符，可以指定范围. [!...]不匹配任何一个字符
                </li>
            </ul>
        </p>
        <h3>
            Tips
        </h3>
        <p>
            shell变量、扩展、函数、循环、分支语句都是shell脚本编程的元素。shell编程是最早的脚本编程，是在perl、python等脚本语言出现之前的唯一选择。但是在更高级现代的脚本语言出现之后，shell脚本编程就没有存在的价值了，甚至sed、awk都已经过时了，perl语言的出现就是为了代替它们，而python的出现又是为了代替perl的。因此不要在花费时间学习shell编程、sed、awk等过时技术，而应该使用python等高级现代的脚本语言。类似的，glob是现代正则表达式出现之前的模式匹配技术，同样应该被现代正则表达式代替。相应地，grep应该被egrep替换。就是说所有古老的技术都应该被现代技术替换。只是bash shell作为通用的shell环境，仍然是访问linux/unix系统的标准接口（尤其是它的管道功能非常强大），它很多操作还会使用shell编程的一些概念，这些仍然需要熟悉，例本页面所讲的扩展。但是变量匹配、if测试、for循环等等都是shell编程才用到的，这些都不需要了。shell环境本身就是shell编程语言的REPL循环（read-evaluate-print-loop），和python、nodejs的REPL一样
        </p>
    </body>
</html>